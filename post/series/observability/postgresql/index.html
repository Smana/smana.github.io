<!doctype html><html lang=en data-figures class=page><head><title>`PostgreSQL`: From Metrics to Query Plan Analysis | Ogenki</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta http-equiv=X-UA-Compatible content="IE=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=XXXXXXXXXX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","XXXXXXXXXX")</script><meta property="og:locale" content="en"><meta property="og:locale:alternate" content="fr"><meta property="og:type" content="article"><meta name=description content="CloudNativePG provides comprehensive PostgreSQL monitoring out of the box‚Äîlet's see how to enhance it with SQL query analysis and query plan history."><meta name=twitter:card content="summary"><meta name=twitter:creator content="@smana.dev"><meta name=twitter:title content="`PostgreSQL`: From Metrics to Query Plan Analysis"><meta name=twitter:image content="https://blog.ogenki.io/post/series/observability/postgresql/thumbnail.png"><meta property="og:url" content="https://blog.ogenki.io/post/series/observability/postgresql/"><meta property="og:title" content="`PostgreSQL`: From Metrics to Query Plan Analysis"><meta property="og:description" content="CloudNativePG provides comprehensive PostgreSQL monitoring out of the box‚Äîlet's see how to enhance it with SQL query analysis and query plan history."><meta property="og:image" content="https://blog.ogenki.io/post/series/observability/postgresql/thumbnail.png"><meta name=keywords content="observability,data"><link rel=apple-touch-icon sizes=180x180 href=https://blog.ogenki.io/icons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.ogenki.io/icons/favicon-32x32.png><link rel=manifest href=https://blog.ogenki.io/icons/site.webmanifest><link rel=canonical href=https://blog.ogenki.io/post/series/observability/postgresql/><link rel=preload href=https://blog.ogenki.io/css/styles.a556cef0edd8ecd9821e661f7f201d84cc18d0c6435703889db2949aea0eccb84b7ac9a2bb49093b03f5e7d9ce21c23c705efd6dcbd7e8018afae9a9f32ca095.css integrity="sha512-pVbO8O3Y7NmCHmYffyAdhMwY0MZDVwOInbKUmuoOzLhLesmiu0kJOwP159nOIcI8cF79bcvX6AGK+ump8yyglQ==" as=style crossorigin=anonymous><link rel=preload href=https://blog.ogenki.io/en/js/bundle.fb0be5bcaafc43d845951fd0966e48e5a7bf36be99ce2176c89d369bb5a8136dfb14e596d145cfa04c4c3b79232ffffd811a01eccee956d9d61cf49330e633c7.js as=script integrity="sha512-+wvlvKr8Q9hFlR/Qlm5I5ae/Nr6ZziF2yJ02m7WoE237FOWW0UXPoExMO3kjL//9gRoB7M7pVtnWHPSTMOYzxw==" crossorigin=anonymous><link rel=stylesheet type=text/css href=https://blog.ogenki.io/css/styles.a556cef0edd8ecd9821e661f7f201d84cc18d0c6435703889db2949aea0eccb84b7ac9a2bb49093b03f5e7d9ce21c23c705efd6dcbd7e8018afae9a9f32ca095.css integrity="sha512-pVbO8O3Y7NmCHmYffyAdhMwY0MZDVwOInbKUmuoOzLhLesmiu0kJOwP159nOIcI8cF79bcvX6AGK+ump8yyglQ==" crossorigin=anonymous></head><body data-code=25 data-lines=false id=documentTop data-lang=en><header class=nav_header><nav class=nav><a href=https://blog.ogenki.io/ class="nav_brand nav_item" title=Ogenki><img src=https://blog.ogenki.io/logos/logo.png class=logo alt=Ogenki><div class=nav_close><div><svg class="icon"><title>open-menu</title><use xlink:href="#open-menu"/></svg>
<svg class="icon"><title>closeme</title><use xlink:href="#closeme"/></svg></div></div></a><div class='nav_body nav_body_left'><div class=nav_parent><a href=https://blog.ogenki.io/ class=nav_item title=Home>Home</a></div><div class=nav_parent><a href=https://blog.ogenki.io/ class=nav_item title=Links>Links <img src=https://blog.ogenki.io/icons/caret-icon.svg alt=icon class=nav_icon></a><div class=nav_sub><span class=nav_child></span>
<a href=https://bsky.app/profile/smana.dev class="nav_child nav_item" title=Bluesky>Bluesky</a>
<a href=https://www.linkedin.com/in/sma%C3%AFne-kahlouch-44374110/ class="nav_child nav_item" title=LinkedIn>LinkedIn</a></div></div><div class=nav_parent><a href=https://blog.ogenki.io/about/ class=nav_item title=About>About</a></div><div class=nav_parent><a href=# class=nav_item>üåê</a><div class=nav_sub><span class=nav_child></span>
<a href=https://blog.ogenki.io/ class="nav_child nav_item">English</a>
<a href=https://blog.ogenki.io/fr/ class="nav_child nav_item">Fran√ßais</a></div></div><div class=follow><a href=https://github.com/Smana><svg class="icon"><title>github</title><use xlink:href="#github"/></svg>
</a><a href=https://www.linkedin.com/in/sma%C3%AFne-kahlouch-44374110/><svg class="icon"><title>linkedin</title><use xlink:href="#linkedin"/></svg>
</a><a href=https://bsky.app/profile/smana.dev><svg class="icon"><title>bluesky</title><use xlink:href="#bluesky"/></svg></a><div class=color_mode><input type=checkbox class=color_choice id=mode></div></div></div></nav></header><main><div class="grid-inverse wrap content"><article class=post_content><h1 class=post_title><code>PostgreSQL</code>: From Metrics to Query Plan Analysis</h1><div class=post_meta><span><svg class="icon"><title>calendar</title><use xlink:href="#calendar"/></svg>
</span><span class=post_date>15-11-2025</span>
<span class=post_time>¬∑ 12 min read</span><span>&nbsp;¬∑ <a href=https://blog.ogenki.io/tags/observability/ title=observability class="post_tag button button_translucent">observability
</a><a href=https://blog.ogenki.io/tags/data/ title=data class="post_tag button button_translucent">data
</a></span><span class=page_only>&nbsp;¬∑<div class=post_share>Share on:
<a href="https://twitter.com/intent/tweet?text=%60PostgreSQL%60%3a%20From%20Metrics%20to%20Query%20Plan%20Analysis&url=https%3a%2f%2fblog.ogenki.io%2fpost%2fseries%2fobservability%2fpostgresql%2f&tw_p=tweetbutton" class=twitter title="Share on Twitter" target=_blank rel=nofollow><svg class="icon"><title>twitter</title><use xlink:href="#twitter"/></svg>
</a><a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.ogenki.io%2fpost%2fseries%2fobservability%2fpostgresql%2f&t=%60PostgreSQL%60%3a%20From%20Metrics%20to%20Query%20Plan%20Analysis" class=facebook title="Share on Facebook" target=_blank rel=nofollow><svg class="icon"><title>facebook</title><use xlink:href="#facebook"/></svg>
</a><a href=#linkedinshare id=linkedinshare class=linkedin title="Share on LinkedIn" rel=nofollow><svg class="icon"><title>linkedin</title><use xlink:href="#linkedin"/></svg>
</a><a href=https://blog.ogenki.io/post/series/observability/postgresql/ title="Copy Link" class="link link_yank"><svg class="icon"><title>copy</title><use xlink:href="#copy"/></svg></a></div></span></div><div class=post_toc><h2>Overview</h2><nav id=TableOfContents><ul><li><a href=#-included-with-cloudnativepg>üìä Included with CloudNativePG</a><ul><li><a href=#collecting-metrics-with-victoriametrics>Collecting Metrics with VictoriaMetrics</a></li><li><a href=#main-metrics-to-monitor>Main Metrics to Monitor</a></li><li><a href=#visualization-with-grafana>Visualization with Grafana</a></li></ul></li><li><a href=#-understanding-query-performance>üîç Understanding Query Performance</a></li><li><a href=#-query-plan-history-implementation-with-open-source-tools>‚ú® Query Plan History: Implementation with Open Source Tools</a><ul><li><a href=#the-architecture>The Architecture</a></li><li><a href=#enabling-performance-insights>Enabling Performance Insights</a></li><li><a href=#-platform-engineering-the-right-level-of-abstraction>üèóÔ∏è Platform Engineering: The Right Level of Abstraction</a></li><li><a href=#understanding-the-configuration>Understanding the Configuration</a></li><li><a href=#vector-log-pipeline-configuration>Vector Log Pipeline Configuration</a></li></ul></li><li><a href=#-analyzing-query-performance-in-action>üî¨ Analyzing Query Performance in Action</a><ul><li><a href=#understanding-explain-output>Understanding EXPLAIN Output</a></li><li><a href=#-visualizing-execution-plans-with-pev2>üé® Visualizing Execution Plans with pev2</a></li><li><a href=#analyzing-with-grafana>Analyzing with Grafana</a></li><li><a href=#workflow-from-grafana-to-pev2>Workflow: From Grafana to pev2</a></li><li><a href=#leveraging-pev2>Leveraging pev2</a></li></ul></li><li><a href=#-final-thoughts>üí≠ Final Thoughts</a></li><li><a href=#-references>üîñ References</a></li></ul></nav></div><div class=post_body><p>Having basic observability when running PostgreSQL in production isn't optional. Whether it's tracking the <a href=https://blog.ogenki.io/post/series/observability/alerts/#-the-golden-signals>Golden Signals</a>, monitoring slow queries, or analyzing connection patterns, this often requires plumbing multiple tools together, configuring various exporters, and manually extracting queries for analysis.</p><p>‚ùì What if we could achieve <strong>complete production-grade monitoring with minimal configuration</strong>?</p><p>In this article, we'll explore how to enhance CloudNativePG's already robust monitoring with simple, effective, and easy-to-use query performance analysis capabilities‚Äîleveraging the power of tools at our disposal: <code>Vector</code>, <code>VictoriaMetrics</code>, and <code>VictoriaLogs</code>.</p><h2 id=-included-with-cloudnativepg>üìä Included with CloudNativePG</h2><p>When you deploy a PostgreSQL cluster with CNPG, the operator <strong>exposes comprehensive metrics</strong> via a dedicated endpoint on each PostgreSQL instance (port 9187). While Grafana dashboards are not included by default, CloudNativePG provides <strong>official dashboard templates</strong> that can be deployed declaratively.</p><p>The metrics exposed include:</p><ul><li><strong>Database Operations</strong>: Transaction rates, queries per second, tuple statistics</li><li><strong>Replication Status</strong>: Lag, streaming state, synchronization metrics</li><li><strong>Resource Utilization</strong>: Connections, cache hit ratio, buffer statistics</li><li><strong>System Health</strong>: Instance status, failover events, backup states</li></ul><div class="notices tip"><div class=label>GitOps and Kubernetes Operators</div><table><tr><td><img src=repo_gift.png style=width:80%></td><td style=vertical-align:middle;padding-left:10px width=70%><p>The examples in this article come from configurations available in the <strong><a href=https://github.com/Smana/cloud-native-ref>Cloud Native Ref</a></strong> repository.</br>It leverages several operators, including <a href=https://cloudnative-pg.io/>CloudNativePG</a> for PostgreSQL management, <a href=https://victoriametrics.com/>VictoriaMetrics</a> for metrics collection, and <a href=https://github.com/VictoriaMetrics/VictoriaLogs>VictoriaLogs</a> for log collection.</p><p>This project aims to <strong>quickly bootstrap a complete platform</strong> that follows best practices in automation, monitoring, security, and more.</br>Comments and contributions are welcome üôè</td></p></tr></table></div><h3 id=collecting-metrics-with-victoriametrics>Collecting Metrics with VictoriaMetrics</h3><p>CloudNativePG automatically exposes metrics on each PostgreSQL pod. Collecting them is enabled by setting this Helm value:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln>1</span><span class=cl><span class=c># CloudNativePG Helm chart</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=nt>monitoring</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>  </span><span class=nt>podMonitorEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div><p>This simple configuration creates a <code>PodMonitor</code> (Prometheus Operator resource) that is automatically converted by the VictoriaMetrics operator into a compatible native resource. Metrics from all PostgreSQL pods (primary and replicas) are thus collected and available in VictoriaMetrics.</p><div class="notices tip"><div class=label>Prometheus Compatibility</div><p>The VictoriaMetrics operator automatically converts Prometheus Operator resources (<code>PodMonitor</code>, <code>ServiceMonitor</code>, etc.) into their VictoriaMetrics equivalents. This transparent conversion allows using CloudNativePG without modification, while benefiting from VictoriaMetrics as the storage backend.</p></div><h3 id=main-metrics-to-monitor>Main Metrics to Monitor</h3><p>CloudNativePG exposes metrics that align perfectly with the <a href=https://blog.ogenki.io/en/post/series/observability/alerts/#-the-golden-signals>Golden Signals</a> methodology discussed in previous articles:</p><p><strong>Latency</strong> ‚è≥</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-promql data-lang=promql><span class=line><span class=ln>1</span><span class=cl><span class=c1># Average query duration</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=kr>rate</span><span class=o>(</span><span class=nv>cnpg_backends_total_seconds_sum</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=kr>rate</span><span class=o>(</span><span class=nv>cnpg_backends_total_seconds_count</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w>
</span></span></span></code></pre></div><p><strong>Traffic</strong> üì∂</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-promql data-lang=promql><span class=line><span class=ln>1</span><span class=cl><span class=c1># Transactions per second</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_xact_commit</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_xact_rollback</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w>
</span></span></span></code></pre></div><p><strong>Errors</strong> ‚ùå</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-promql data-lang=promql><span class=line><span class=ln>1</span><span class=cl><span class=c1># Connection failures and deadlocks</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_deadlocks</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=kr>rate</span><span class=o>(</span><span class=nv>cnpg_pg_postmaster_start_time_seconds</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w>
</span></span></span></code></pre></div><p><strong>Saturation</strong> üìà</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-promql data-lang=promql><span class=line><span class=ln>1</span><span class=cl><span class=c1># Connection pool usage</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=nv>cnpg_backends_total</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nv>cnpg_pg_settings_max_connections</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span><span class=c1># Cache hit ratio (should be &gt; 95%)</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=k>sum</span><span class=o>(</span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_blks_hit</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>))</span><span class=w> </span><span class=o>/</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>  </span><span class=o>(</span><span class=k>sum</span><span class=o>(</span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_blks_hit</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>))</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=k>sum</span><span class=o>(</span><span class=kr>rate</span><span class=o>(</span><span class=nv>pg_stat_database_blks_read</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)))</span><span class=w>
</span></span></span></code></pre></div><h3 id=visualization-with-grafana>Visualization with Grafana</h3><p>Using the Grafana Operator explored in <a href=https://blog.ogenki.io/en/post/series/observability/metrics/#-visualizing-metrics-with-the-grafana-operator>previous articles</a>, we can deploy CNPG dashboards declaratively:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>grafana.integreatly.org/v1beta1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>GrafanaDashboard</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>databases-cloudnative-pg</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>allowCrossNamespaceImport</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>folderRef</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;databases&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>datasources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span>- <span class=nt>inputName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;DS_PROMETHEUS&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>datasourceName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;VictoriaMetrics&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>instanceSelector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>dashboards</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;grafana&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>  </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://grafana.com/api/dashboards/20417/revisions/4/download&#34;</span><span class=w>
</span></span></span></code></pre></div><p>The dashboard provides detailed views of our PostgreSQL clusters, including replication lag, query performance, and resource utilization.</p><center><img src=grafana_cnpg.png width=1000 alt="CloudNativePG Grafana"></center><h2 id=-understanding-query-performance>üîç Understanding Query Performance</h2><p>While metrics give us the "<em>what</em>" and "<em>when</em>," they don't always tell us the "<em>why</em>." This is where query performance analysis becomes essential. Knowing that queries are slow is useful; understanding <strong>why</strong> they're slow often leads us to optimization opportunities.</p><p>Traditional PostgreSQL query analysis requires manually running <code>EXPLAIN</code> and <code>EXPLAIN ANALYZE</code> commands. While powerful, this approach has limitations:</p><ul><li><strong>Reactive</strong>: You only analyze queries you suspect are problematic</li><li><strong>Manual</strong>: Requires active investigation by DBAs</li><li><strong>Point-in-time</strong>: Captures current execution plan, not historical trends</li><li><strong>Incomplete</strong>: Difficult to correlate with production load patterns</li></ul><p>Ideally, we need <strong>automatic and continuous query plan capture</strong> that allows us to:</p><ol><li>Automatically identify slow queries</li><li>Track execution plan changes over time</li><li>Correlate query performance with system metrics</li><li>Debug performance issues without manually reproducing them</li></ol><p>This is exactly what some managed solutions offer. But can we achieve the same on Kubernetes?</p><h2 id=-query-plan-history-implementation-with-open-source-tools>‚ú® Query Plan History: Implementation with Open Source Tools</h2><p>The good news is that we can build a sophisticated query performance monitoring system that rivals commercial offerings with minimal configuration.</p><h3 id=the-architecture>The Architecture</h3><center><img src=architecture.png width=700></center><p>Our solution leverages two PostgreSQL extensions and a configuration parameter, integrating them with the VictoriaMetrics ecosystem:</p><p><strong>PostgreSQL Extensions</strong>:</p><ul><li><strong>pg_stat_statements</strong>: Aggregates query execution statistics</li><li><strong>auto_explain</strong>: Automatically captures execution plans for slow queries</li></ul><p><strong>PostgreSQL Configuration</strong>:</p><ul><li><strong>compute_query_id</strong>: Parameter that generates unique identifiers for query correlation</li></ul><p><strong>Observability Stack</strong>:</p><ul><li><strong>VictoriaMetrics</strong>: Stores query metrics from pg_stat_statements</li><li><strong>VictoriaLogs</strong>: Stores execution plans with query correlation</li><li><strong>Vector</strong>: Parses PostgreSQL logs and extracts execution plans</li><li><strong>Grafana</strong>: Visualizes performance data and enables plan history exploration</li></ul><p>The key is the link between all these elements: the <strong>correlation between metrics and logs</strong> using the query identifier. This allows us to:</p><ol><li>See that a query is slow (from metrics)</li><li>Click to view its execution plan history (from logs)</li><li>Identify plan changes that caused performance regressions</li></ol><p>I've called this feature "<strong>Performance Insights</strong>". Any resemblance to an existing solution would be purely coincidental üòÜ.</p><h3 id=enabling-performance-insights>Enabling Performance Insights</h3><p>Thanks to CloudNativePG's "<a href=https://cloudnative-pg.io/documentation/1.27/postgresql_conf/#managed-extensions>Managed Extensions</a>" feature, enabling PostgreSQL extensons is very easy.</p><h3 id=-platform-engineering-the-right-level-of-abstraction>üèóÔ∏è Platform Engineering: The Right Level of Abstraction</h3><p>One of the key principles of platform engineering is providing the right level of abstraction to application developers. They shouldn't need to understand PostgreSQL internals or memorize 15+ PostgreSQL-specific configuration parameters.</p><p>This is where <strong>Crossplane compositions</strong> shine. In the Cloud Native Ref project, we use Crossplane with KCL (Kubernetes Configuration Language) to create a higher-level abstraction called <code>SQLInstance</code>.</p><p><strong>Without Composition</strong> (Raw CNPG Cluster):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>postgresql.cnpg.io/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Cluster</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-postgres</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>instances</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>postgresql</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>shared_preload_libraries</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span>- <span class=l>pg_stat_statements</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span>- <span class=l>auto_explain</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span><span class=nt>parameters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>pg_stat_statements.max</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10000&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>pg_stat_statements.track</span><span class=p>:</span><span class=w> </span><span class=l>all</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>pg_stat_statements.track_utility</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>      </span><span class=nt>pg_stat_statements.track_planning</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>pg_stat_statements.save</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_format</span><span class=p>:</span><span class=w> </span><span class=l>json</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_min_duration</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1000&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_analyze</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_buffers</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_timing</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;off&#34;</span><span class=w>  </span><span class=c># Optimization to reduce overhead (PostgreSQL default: on)</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_triggers</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_verbose</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.log_nested_statements</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=w>      </span><span class=nt>auto_explain.sample_rate</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.2&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=w>      </span><span class=nt>compute_query_id</span><span class=p>:</span><span class=w> </span><span class=kc>on</span><span class=w>
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=w>      </span><span class=nt>track_activity_query_size</span><span class=p>:</span><span class=w> </span><span class=m>2048</span><span class=w>
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=w>      </span><span class=nt>track_io_timing</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;on&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=w>      </span><span class=nt>log_min_duration_statement</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=w>      </span><span class=c># ... and more</span><span class=w>
</span></span></span></code></pre></div><p><strong>With Composition</strong> (Platform Engineering Approach):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>cloud.ogenki.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>App</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>sqlInstance</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>size</span><span class=p>:</span><span class=w> </span><span class=l>small</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>storageSize</span><span class=p>:</span><span class=w> </span><span class=l>20Gi</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>instances</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span><span class=nt>performanceInsights</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>explain</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=nt>sampleRate: 0.2       # 20% sampling (default</span><span class=p>:</span><span class=w> </span><span class=l>safe for production)</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>        </span><span class=nt>minDuration</span><span class=p>:</span><span class=w> </span><span class=m>1000</span><span class=w>     </span><span class=c># Log queries &gt; 1 second (default)</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>logStatement: none      # Optional</span><span class=p>:</span><span class=w> </span><span class=l>none (default) / ddl / mod / all</span><span class=w>
</span></span></span></code></pre></div><p>The Crossplane composition <a href=https://github.com/Smana/cloud-native-ref/tree/main/infrastructure/base/crossplane/configuration/kcl/cloudnativepg><strong>SQLInstance</strong></a> handles all the complexity.</p><p>This composition approach provides several benefits:</p><ol><li><strong>Developer Experience</strong>: Application developers don't need PostgreSQL expertise</li><li><strong>Consistency</strong>: Performance monitoring is configured uniformly across all databases</li><li><strong>Maintainability</strong>: Platform team controls monitoring configuration centrally</li><li><strong>Scalability</strong>: Easy to update monitoring parameters for all instances</li><li><strong>Discoverability</strong>: Developers can browse available options (<code>performanceInsights: true</code>) rather than memorizing parameter names</li></ol><div class="notices tip"><div class=label>Platform Engineering Principle</div><p>The best abstractions <strong>hide complexity without limiting power</strong>. Developers get performance insights with simple parameters, while the platform team is still able to fine-tune the underlying PostgreSQL configuration for advanced use cases.</p></div><h3 id=understanding-the-configuration>Understanding the Configuration</h3><p>Let's break down what each component does:</p><p><strong>pg_stat_statements</strong>: This extension tracks execution statistics for all SQL statements executed by a server. It records:</p><ul><li>Total execution time and number of calls</li><li>Rows processed and returned</li><li>Buffer hits and reads</li><li>Query planning time</li></ul><p><strong>auto_explain</strong>: Automatically logs execution plans for queries exceeding a duration threshold. Key parameters include:</p><ul><li><code>log_format: json</code>: Structured output for parsing</li><li><code>log_min_duration: 1000</code>: Capture queries taking more than 1 second (default)</li><li><code>log_analyze: on</code>: Include actual row counts (includes ANALYZE data from the actual execution)</li><li><code>sample_rate: 0.2</code>: Sample 20% of slow queries to reduce overhead (composition default; PostgreSQL default is 1.0)</li></ul><p><strong>compute_query_id</strong>: The correlation key that ties everything together. This generates a unique identifier for each query that appears in both pg_stat_statements metrics and auto_explain logs.</p><div class="notices info"><div class=label>Composition Default Values</div><p>The SQLInstance composition sets production-safe defaults (different from PostgreSQL defaults):</p><ul><li><code>sampleRate: 0.2</code> ‚Üí 20% sampling (PostgreSQL default: 1.0 = 100%)</li><li><code>minDuration: 1000ms</code> ‚Üí Queries > 1 second (PostgreSQL default: -1 = disabled)</li></ul><p>For <strong>debugging</strong>, you can override these:</p><ul><li><code>sampleRate: 1.0</code> ‚Üí 100% of slow queries</li><li><code>minDuration: 0</code> ‚Üí All queries, even the fastest ones</li></ul></div><h3 id=vector-log-pipeline-configuration>Vector Log Pipeline Configuration</h3><p>Here's what Vector does concretely - <strong>transforming a PostgreSQL auto_explain log into an indexable event</strong>:</p><table><thead><tr><th><strong>Raw Log (CloudNativePG)</strong></th><th><strong>After Vector Parsing</strong></th></tr></thead><tbody><tr><td><pre lang=json style=font-size:.75em>{<br>  &quot;timestamp&quot;: &quot;2025-01-15T14:32:18.456Z&quot;,<br>  &quot;message&quot;: &quot;{\&quot;level\&quot;:\&quot;info\&quot;,<br>    \&quot;record\&quot;:{\&quot;query_id\&quot;:\&quot;8765432109876543210\&quot;,<br>      \&quot;database_name\&quot;:\&quot;production\&quot;,<br>      \&quot;message\&quot;:\&quot;duration: 245.678 ms plan:\\n{...}\&quot;<br>    }<br>  }&quot;,<br>  &quot;kubernetes&quot;: {<br>    &quot;pod_labels&quot;: {<br>      &quot;cnpg.io/cluster&quot;: &quot;myapp-postgres&quot;<br>    }<br>  }<br>}</pre></td><td><pre lang=json style=font-size:.75em>{<br>  &quot;_time&quot;: &quot;2025-01-15T14:32:18.456Z&quot;,<br>  &quot;cluster_name&quot;: &quot;myapp-postgres&quot;,<br>  &quot;namespace&quot;: &quot;apps&quot;,<br>  &quot;database&quot;: &quot;production&quot;,<br>  &quot;query_id&quot;: &quot;8765432109876543210&quot;,<br>  &quot;duration_ms&quot;: 245.678,<br>  &quot;query_text&quot;: &quot;SELECT users.email...&quot;,<br>  &quot;plan_json&quot;: {<br>    &quot;Node Type&quot;: &quot;Hash Join&quot;,<br>    &quot;...&quot;<br>  }<br>}</pre></td></tr></tbody></table><h4 id=3-step-pipeline>3-Step Pipeline</h4><p>The Vector pipeline consists of <strong>3 transforms</strong> and <strong>2 sinks</strong> (<a href=https://github.com/Smana/cloud-native-ref/blob/main/observability/base/victoria-logs/helmrelease-vlsingle.yaml#L62-L338>complete configuration</a>):</p><p><strong>1. Parse CloudNativePG JSON logs</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>if .kubernetes.container_name == &#34;postgres&#34; &amp;&amp; exists(.kubernetes.pod_labels.&#34;cnpg.io/cluster&#34;) {
</span></span><span class=line><span class=ln>2</span><span class=cl>  .log = parse_json(.message)
</span></span><span class=line><span class=ln>3</span><span class=cl>}
</span></span></code></pre></div><p><strong>2. Filter for execution plans</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>exists(.log.record.message) &amp;&amp; contains(.log.record.message, &#34;plan:&#34;)
</span></span></code></pre></div><p><strong>3. Extract metadata and plan</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-zed data-lang=zed><span class=line><span class=ln>1</span><span class=cl><span class=p>.</span><span class=n>query_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>to_string</span><span class=o>!</span><span class=p>(.</span><span class=n>log</span><span class=p>.</span><span class=n>record</span><span class=p>.</span><span class=n>query_id</span><span class=p>)</span><span class=w>  </span><span class=err>#</span><span class=w> </span><span class=n>Correlation</span><span class=w> </span><span class=n>key</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w></span><span class=p>.</span><span class=n>cluster_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>.</span><span class=n>kubernetes</span><span class=p>.</span><span class=n>pod_labels</span><span class=p>.</span><span class=err>&#34;</span><span class=n>cnpg</span><span class=p>.</span><span class=nn>io/</span><span class=n>cluster</span><span class=err>&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=p>.</span><span class=n>database</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>.</span><span class=n>log</span><span class=p>.</span><span class=n>record</span><span class=p>.</span><span class=n>database_name</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span><span class=err>#</span><span class=w> </span><span class=n>Parse</span><span class=w> </span><span class=n>plan</span><span class=w> </span><span class=n>JSON</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=err>&#34;</span><span class=n>duration</span><span class=o>:</span><span class=w> </span><span class=n>X</span><span class=w> </span><span class=n>ms</span><span class=w> </span><span class=n>plan</span><span class=o>:</span><span class=w> </span><span class=p>{...}</span><span class=err>&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=p>.</span><span class=n>plan_json</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>parse_json</span><span class=p>(</span><span class=n>split</span><span class=p>(.</span><span class=n>log</span><span class=p>.</span><span class=n>record</span><span class=p>.</span><span class=n>message</span><span class=p>,</span><span class=w> </span><span class=err>&#34;</span><span class=n>plan</span><span class=o>:</span><span class=err>&#34;</span><span class=p>)[</span><span class=err>1</span><span class=p>])</span><span class=w>
</span></span></span></code></pre></div><p>Parsed events are sent to two sinks:</p><ul><li><strong>Successful plans</strong> ‚Üí VictoriaLogs with indexing on <code>cluster_name,namespace,database,query_id</code></li><li><strong>Parse failures</strong> ‚Üí Separate stream for debugging</li></ul><h4 id=the-key-correlation-via-query_id>The Key: Correlation via query_id</h4><p>The critical element is <strong>query_id</strong> which appears in both systems:</p><ul><li><strong>VictoriaMetrics</strong>: <code>pg_stat_statements{queryid="8765432109876543210"}</code> (metrics)</li><li><strong>VictoriaLogs</strong>: <code>{query_id="8765432109876543210"}</code> (plans)</li></ul><p>This correlation allows instant jumping from a performance metric to execution plan history.</p><h2 id=-analyzing-query-performance-in-action>üî¨ Analyzing Query Performance in Action</h2><p>Once we've identified a problematic query, we can view its execution plan history in VictoriaLogs. Using the query_id from pg_stat_statements, we can query <code>VictoriaLogs</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl># Find all execution plans for a specific query
</span></span><span class=line><span class=ln>2</span><span class=cl>{cluster_name=&#34;myapp-postgres&#34;, query_id=&#34;1234567890&#34;} | limit 50
</span></span></code></pre></div><p>This shows us:</p><ul><li>All captured execution plans for this query over time</li><li>Plan variations (e.g., index scans vs. sequential scans)</li><li>Actual row counts and execution times</li><li>Buffer usage and I/O statistics</li></ul><h3 id=understanding-explain-output>Understanding EXPLAIN Output</h3><p>When auto_explain captures a plan, it provides detailed information:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=ln> 1</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=nt>&#34;Query Text&#34;</span><span class=p>:</span> <span class=s2>&#34;SELECT * FROM users WHERE email = ?&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=nt>&#34;Query Identifier&#34;</span><span class=p>:</span> <span class=mi>1234567890</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=nt>&#34;Duration&#34;</span><span class=p>:</span> <span class=mf>1567.234</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=nt>&#34;Plan&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=nt>&#34;Node Type&#34;</span><span class=p>:</span> <span class=s2>&#34;Seq Scan&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=nt>&#34;Relation Name&#34;</span><span class=p>:</span> <span class=s2>&#34;users&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=nt>&#34;Actual Rows&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=nt>&#34;Actual Loops&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=nt>&#34;Actual Total Time&#34;</span><span class=p>:</span> <span class=mf>1567.123</span><span class=p>,</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=nt>&#34;Shared Hit Blocks&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>,</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=nt>&#34;Shared Read Blocks&#34;</span><span class=p>:</span> <span class=mi>54321</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=ln>14</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Key insights from this plan:</p><ul><li><strong>Sequential Scan</strong>: Scanning the entire table instead of using an index</li><li><strong>High block reads</strong>: 54,321 blocks read from disk (poor cache usage)</li><li><strong>Single row returned</strong>: Despite scanning the entire table</li></ul><p>This immediately suggests the need for an index on the <code>email</code> column.</p><h3 id=-visualizing-execution-plans-with-pev2>üé® Visualizing Execution Plans with pev2</h3><p>Understanding complex execution plans from logs can be challenging. This is where <strong><a href=https://github.com/dalibo/pev2>pev2</a></strong> (PostgreSQL Explain Visualizer 2) becomes very useful. It's a web tool that transforms JSON execution plans into interactive, visual diagrams.</p><p>To ensure sensitive query data never leaves the network, pev2 is self-hosted in the cluster via the <a href=https://github.com/Smana/cloud-native-ref/tree/main/infrastructure/base/crossplane/configuration/kcl/app>App</a> composition. This once again demonstrates the <strong>platform abstraction level</strong>: deploying a static web tool uses the same declarative API as a complete application with a database.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>cloud.ogenki.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>App</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>xplane-pev2</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>tooling</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>image</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>repository</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/smana/pev2</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;v1.17.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;32Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;300m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;128Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>  </span><span class=c># Accessible only via Tailscale VPN at: https://pev2.priv.cloud.ogenki.io</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>  </span><span class=nt>route</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>    </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;pev2&#34;</span><span class=w> </span><span class=c># Results in: pev2.priv.cloud.ogenki.io</span><span class=w>
</span></span></span></code></pre></div><h3 id=analyzing-with-grafana>Analyzing with Grafana</h3><p>Grafana integration allows quick identification of problematic queries and navigation to their execution plans.</p><p><strong>Performance Analysis Dashboard</strong></p><center><img src=grafana_perf_analysis.png width=1000 alt="Grafana Dashboard - Performance Analysis"></center><p>This dashboard displays key metrics from <code>pg_stat_statements</code>: top queries by total duration, average latency, number of calls. Each <code>query_id</code> is clickable to explore details.</p><p><strong>Correlation Dashboard</strong></p><center><img src=grafana_plan_correlation.png width=1000 alt="Grafana Dashboard - Metrics/Logs Correlation"></center><p>This dashboard correlates metrics (VictoriaMetrics) with execution plans (VictoriaLogs) for a specific query. It shows performance evolution and plan changes over time.</p><h3 id=workflow-from-grafana-to-pev2>Workflow: From Grafana to pev2</h3><p>The video below shows the complete investigation workflow: from identifying a slow query in Grafana to visual plan analysis with pev2.</p><center><video id=QueryPlan controls width=1000 autoplay loop muted>
<source src=workflow.mp4 type=video/mp4>Your browser does not support the video tag.
</video>
<script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("QueryPlan");e.playbackRate=1.5})</script></center><p><strong>Workflow steps</strong>:</p><ol><li><strong>Identify the slow query</strong> in the Grafana dashboard (<code>pg_stat_statements</code> metrics)</li><li><strong>Click on the query_id</strong> to view plan history in VictoriaLogs</li><li><strong>Copy the JSON plan</strong> and open pev2 (<code>https://pev2.priv.cloud.ogenki.io</code>)</li><li><strong>Paste the plan</strong> (Ctrl+V) to visualize execution</li></ol><h3 id=leveraging-pev2>Leveraging pev2</h3><center><img src=pev2_query_plan.png width=900 alt="pev2 Execution Plan Visualization"></center><p><strong>pev2</strong> transforms JSON plans into interactive diagrams that instantly reveal:</p><ul><li><strong>Bottlenecks</strong>: Larger nodes = higher execution time (orange/yellow badges = warnings)</li><li><strong>Planner estimates</strong>: Discrepancies between estimated and actual rows (e.g., "under estimated by 443√ó" visible on the main Hash Join)</li><li><strong>Inefficient sequential scans</strong>: Indicators on large tables suggesting missing indexes</li><li><strong>Join strategies</strong>: Hash Join, Nested Loop, Merge Join with their respective costs</li><li><strong>I/O patterns</strong>: Ratios of blocks read from disk vs. cache (buffer hits)</li></ul><p>The interactive interface allows <strong>clicking on each node</strong> to view details (cost, timing, row count, buffers). <strong>Warning badges</strong> immediately signal potential issues (wrong estimates, inefficient scans).</p><p>For performance regressions, VictoriaLogs allows comparing plans before/after by filtering by time period (<code>_time:[...]</code>), revealing changes in PostgreSQL planner strategy.</p><h2 id=-final-thoughts>üí≠ Final Thoughts</h2><p>We've built in this article a complete PostgreSQL performance analysis system that combines <strong>metrics</strong> (<code>pg_stat_statements</code>), <strong>execution plans</strong> (<code>auto_explain</code>), and <strong>visualization</strong> (pev2). The key to this approach lies in <strong>correlation via query_id</strong>: from a Grafana dashboard showing a slow query, a few clicks are enough to navigate to its execution plan visualized in pev2, enabling performance analysis and optimization.</p><p>This is, once again, a demonstration of the <strong>power of available open source tools</strong>. CloudNativePG with added extensions, VictoriaMetrics and VictoriaLogs efficiently store metrics and logs, Vector parses and structures data, and Grafana offers unified visualization. This Kubernetes-native approach is portable and gives complete control.</p><p>Furthermore the <code>App</code> and <code>SQLInstance</code> Crossplane compositions allow to enable <em>Performance Insights</em> only by setting <code>performanceInsights.enabled: true</code> with a few tuning parameters (<code>sampleRate</code>, <code>minDuration</code>). Developers don't need to understand PostgreSQL internals or Vector‚Äîthe platform masks the complexity. This same declarative API deploys both a complete database and a static web tool like pev2, demonstrating the consistency of the abstraction level.</p><p>The <a href=https://github.com/Smana/cloud-native-ref>cloud-native-ref</a> project brings all these pieces together and shows how Gateway API, Tailscale, Crossplane/KCL, and the VictoriaMetrics ecosystem assemble to create a complete observability platform.</p><div class="notices note"><div class=label>Performance Consideration</div><p>Enabling Performance Insights involves an estimated overhead of <strong>3-4% CPU</strong> and <strong>~200-250MB memory</strong> with default values:</p><ul><li><code>pg_stat_statements</code>: ~1% CPU, 50-100MB RAM</li><li><code>auto_explain</code> (sample_rate=0.2, log_timing=off): ~1% CPU, 50-100MB RAM</li><li><code>Vector</code> parsing: &lt;1% CPU, ~128MB RAM</li></ul><p>The default values (<code>sampleRate: 0.2</code>, <code>minDuration: 1000</code>) are suitable for production. Adjust according to your needs:</p><ul><li><strong>High-traffic production</strong>: <code>sampleRate: 0.1</code> (10%) + <code>minDuration: 3000</code> (>3s) ‚Äî reduce overhead to ~2-3% CPU</li><li><strong>Debugging/Development</strong>: <code>sampleRate: 1.0</code> (100%) + <code>minDuration: 0</code> + <code>log_timing: on</code> ‚Äî ~5-7% CPU overhead for maximum capture</li><li><strong>Standard production</strong>: default values (<code>sampleRate: 0.2</code>, <code>minDuration: 1000</code>) ‚Äî excellent balance at 3-4% CPU</li></ul><p>The <code>sampleRate</code>, <code>log_timing</code>, and <code>logStatement</code> parameters allow fine-tuning performance impact.</p></div><h2 id=-references>üîñ References</h2><p><strong>CloudNativePG Documentation</strong></p><ul><li><a href=https://cloudnative-pg.io/documentation/>CloudNativePG Official Documentation</a></li><li><a href=https://cloudnative-pg.io/documentation/current/managed_extensions/>Auto-Managed Extensions</a></li><li><a href=https://cloudnative-pg.io/documentation/current/monitoring/>Monitoring and Observability</a></li></ul><p><strong>PostgreSQL Extensions and Features</strong></p><ul><li><a href=https://www.postgresql.org/docs/current/pgstatstatements.html>pg_stat_statements</a> - Query statistics extension</li><li><a href=https://www.postgresql.org/docs/current/auto-explain.html>auto_explain</a> - Automatic execution plan logging</li><li><a href=https://www.postgresql.org/docs/14/runtime-config-statistics.html#GUC-COMPUTE-QUERY-ID>compute_query_id</a> - Query identifier generation</li><li><a href=https://www.postgresql.org/docs/current/sql-explain.html>EXPLAIN Documentation</a> - Understanding query plans</li></ul><p><strong>VictoriaMetrics Ecosystem</strong></p><ul><li><a href=https://docs.victoriametrics.com/>VictoriaMetrics Documentation</a></li><li><a href=https://docs.victoriametrics.com/victorialogs/logsql/>VictoriaLogs LogsQL</a></li><li><a href=https://vector.dev/docs/reference/vrl/>Vector VRL Language</a></li></ul><p><strong>Query Plan Visualization</strong></p><ul><li><a href=https://github.com/dalibo/pev2>pev2 (PostgreSQL Explain Visualizer 2)</a> - Interactive execution plan visualization</li><li><a href=https://hub.docker.com/r/dalibo/pev2>pev2 Docker Image</a> - Self-hosted deployment</li></ul><p><strong>Configuration and Implementation</strong></p><ul><li><a href=https://github.com/Smana/cloud-native-ref/blob/main/observability/base/victoria-logs/README.md>Vector VRL Configuration</a> - PostgreSQL log parsing pipeline</li><li><a href=https://github.com/Smana/cloud-native-ref/blob/main/infrastructure/base/crossplane/configuration/kcl/cloudnativepg/README.md>CloudNativePG Composition</a> - SQLInstance abstraction with KCL</li><li><a href=https://github.com/Smana/cloud-native-ref/blob/main/docs/postgresql-monitoring-architecture.md>PostgreSQL Monitoring Architecture</a> - Complete architecture documentation</li></ul></div><h2 class=post_related>Posts in this series</h2><ul></ul><div class=post_comments></div><div class=post_i18n><h3 class=mb-0>Translations:</h3><nav class=tags_nav><a href=https://blog.ogenki.io/fr/post/series/observability/postgresql/ class="post_tag button button_translucent">Fran√ßais</a></nav></div></article><aside class=sidebar><section class=sidebar_inner><br><div class=search><input type=search class="search_field form_field" placeholder=Search... id=find autocomplete=off data-scope=post>
<label for=find class=search_label><svg class="icon"><title>search</title><use xlink:href="#search"/></svg></label><div class="search_results results"></div></div><div class=author_header><img src=https://blog.ogenki.io/images/smana.jpg alt="Smaine Kahlouch photo"><h2>Smaine Kahlouch</h2></div><div class=author_bio>Lead SRE/DevOps, Team leader, Open Source enthusiast.</div><a href=https://blog.ogenki.io/about/ class="button mt-1" role=button title='Read More'>Read More</a><h2 class=mt-4>Posts in this series</h2><ul></ul><h2 class=mt-4>Featured Posts</h2><ul><li><a href=https://blog.ogenki.io/post/series/observability/postgresql/ class=nav-link title="`PostgreSQL`: From Metrics to Query Plan Analysis"><code>PostgreSQL</code>: From Metrics to Query Plan Analysis</a></li><li><a href=https://blog.ogenki.io/post/series/observability/logs/ class=nav-link title="`VictoriaLogs`: What if logs management became simple and performant?"><code>VictoriaLogs</code>: What if logs management became simple and performant?</a></li><li><a href=https://blog.ogenki.io/post/series/observability/alerts/ class=nav-link title="`VictoriaMetrics` : Effective alerts, from theory to practice üõ†Ô∏è"><code>VictoriaMetrics</code> : Effective alerts, from theory to practice üõ†Ô∏è</a></li><li><a href=https://blog.ogenki.io/post/series/observability/metrics/ class=nav-link title="Harness the Power of `VictoriaMetrics` and `Grafana` Operators for Metrics Management">Harness the Power of <code>VictoriaMetrics</code> and <code>Grafana</code> Operators for Metrics Management</a></li><li><a href=https://blog.ogenki.io/post/pki-gapi/ class=nav-link title="`TLS` with Gateway API: Efficient and Secure Management of Public and Private Certificates"><code>TLS</code> with Gateway API: Efficient and Secure Management of Public and Private Certificates</a></li></ul><h2 class=mt-4>Recent Posts</h2><ul class=flex-column><li><a href=https://blog.ogenki.io/post/dagger-intro/ class=nav-link title="`Dagger`: The missing piece of the developer experience?"><code>Dagger</code>: The missing piece of the developer experience?</a></li><li><a href=https://blog.ogenki.io/post/crossplane_composition_functions/ class=nav-link title="Going Further with `Crossplane`: Compositions and Functions">Going Further with <code>Crossplane</code>: Compositions and Functions</a></li><li><a href=https://blog.ogenki.io/post/tailscale/ class=nav-link title="Beyond Traditional VPNs: Simplifying Cloud Access with `Tailscale`">Beyond Traditional VPNs: Simplifying Cloud Access with <code>Tailscale</code></a></li><li><a href=https://blog.ogenki.io/post/cilium-gateway-api/ class=nav-link title="`Gateway API`: Can I replace my Ingress Controller with `Cilium`?"><code>Gateway API</code>: Can I replace my Ingress Controller with <code>Cilium</code>?</a></li><li><a href=https://blog.ogenki.io/post/terraform-controller/ class=nav-link title="Applying GitOps Principles to Infrastructure: An overview of `tf-controller`">Applying GitOps Principles to Infrastructure: An overview of <code>tf-controller</code></a></li><li><a href=https://blog.ogenki.io/post/cnpg/ class=nav-link title="`CloudNativePG`: An easy way to run PostgreSQL on Kubernetes"><code>CloudNativePG</code>: An easy way to run PostgreSQL on Kubernetes</a></li><li><a href=https://blog.ogenki.io/post/devflux/ class=nav-link title="100% `GitOps` using Flux">100% <code>GitOps</code> using Flux</a></li><li><a href=https://blog.ogenki.io/post/crossplane_k3d/ class=nav-link title="My Kubernetes cluster (GKE) with `Crossplane`">My Kubernetes cluster (GKE) with <code>Crossplane</code></a></li></ul><div><h2 class="mt-4 taxonomy" id=categories-section>Categories</h2><nav class=tags_nav><a href=https://blog.ogenki.io/categories/containers/ class="post_tag button button_translucent" title=containers>CONTAINERS
<span class=button_tally>7</span>
</a><a href=https://blog.ogenki.io/categories/devxp/ class="post_tag button button_translucent" title=devxp>DEVXP
<span class=button_tally>6</span></a></nav></div><div><h2 class="mt-4 taxonomy" id=series-section>Series</h2><nav class=tags_nav><a href=https://blog.ogenki.io/series/workshop-kubernetes/ class="post_tag button button_translucent" title="workshop kubernetes">WORKSHOP KUBERNETES
<span class=button_tally>7</span>
</a><a href=https://blog.ogenki.io/series/workshop-helm/ class="post_tag button button_translucent" title="workshop helm">WORKSHOP HELM
<span class=button_tally>6</span>
</a><a href=https://blog.ogenki.io/series/observability/ class="post_tag button button_translucent" title=observability>OBSERVABILITY
<span class=button_tally>4</span></a></nav></div><div><h2 class="mt-4 taxonomy" id=tags-section>Tags</h2><nav class=tags_nav><a href=https://blog.ogenki.io/tags/kubernetes/ class="post_tag button button_translucent" title=kubernetes>KUBERNETES
<span class=button_tally>15</span>
</a><a href=https://blog.ogenki.io/tags/helm/ class="post_tag button button_translucent" title=helm>HELM
<span class=button_tally>6</span>
</a><a href=https://blog.ogenki.io/tags/infrastructure/ class="post_tag button button_translucent" title=infrastructure>INFRASTRUCTURE
<span class=button_tally>4</span>
</a><a href=https://blog.ogenki.io/tags/observability/ class="post_tag button button_translucent" title=observability>OBSERVABILITY
<span class=button_tally>4</span>
</a><a href=https://blog.ogenki.io/tags/devxp/ class="post_tag button button_translucent" title=devxp>DEVXP
<span class=button_tally>3</span>
</a><a href=https://blog.ogenki.io/tags/data/ class="post_tag button button_translucent" title=data>DATA
<span class=button_tally>2</span>
</a><a href=https://blog.ogenki.io/tags/gitops/ class="post_tag button button_translucent" title=gitops>GITOPS
<span class=button_tally>2</span>
</a><a href=https://blog.ogenki.io/tags/network/ class="post_tag button button_translucent" title=network>NETWORK
<span class=button_tally>2</span>
</a><a href=https://blog.ogenki.io/tags/security/ class="post_tag button button_translucent" title=security>SECURITY
<span class=button_tally>2</span>
</a><a href=https://blog.ogenki.io/tags/index/ class="post_tag button button_translucent" title=index>INDEX
<span class=button_tally>1</span>
</a><a href=https://blog.ogenki.io/tags/local/ class="post_tag button button_translucent" title=local>LOCAL
<span class=button_tally>1</span>
</a><a href=https://blog.ogenki.io/tags/tooling/ class="post_tag button button_translucent" title=tooling>TOOLING
<span class=button_tally>1</span></a></nav></div></section></aside></div></main><svg width="0" height="0" class="hidden"><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter"><path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68.0 01-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043.0-1.924.366-2.643 1.078A3.56 3.56.0 008.766 5.383c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846.0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47.0.929.273 1.705.82 2.388a3.623 3.623.0 002.115 1.291c-.312.08-.641.118-.979.118-.312.0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652.0 002.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422.0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139.0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77.0 001.172-4.892v-.468a7.788 7.788.0 001.84-1.921 8.142 8.142.0 01-2.11.593z"/></symbol><symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar"><path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916.0 1e2v352c0 33.084 26.916 60 60 60h392c33.084.0 60-26.916 60-60V1e2c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028.0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028.0 20 8.972 20 20v48z"/><path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github"><path d="M255.968 5.329C114.624 5.329.0 120.401.0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384.0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008.0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992.0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584.0 34.368-.32 62.08-.32 70.496.0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab"><path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6.0L12.3 74.8z"/><path d="M12.3 74.7.5 111c-1 3.2.0 6.8 3 8.8l101.6 74-92.5-119z"/><path d="M105 193.7l-38.6-119h-54l92.7 119z"/><path d="M105 193.7l38.7-119H66.4l38.7 119z"/><path d="M105 193.7l38.7-119H198l-93 119z"/><path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/><path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6.0L198 74.8z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss"><circle cx="3.429" cy="20.571" r="3.429"/><path d="M11.429 24h4.57C15.999 15.179 8.821 8.001.0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"/><path d="M24 24C24 10.766 13.234.0.0.0v4.571c10.714.0 19.43 8.714 19.43 19.429z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin"><path d="M437 0H75C33.648.0.0 33.648.0 75v362c0 41.352 33.648 75 75 75h362c41.352.0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top"><path d="M604.501 440.509 325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298.0 36.323s26.223 10.024 36.222.0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221.0 9.999-10.023 9.999-26.298.0-36.323z"/></symbol><symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly"><path d="M504.971 239.029 448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c19.851.0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002.0 004e2 320v108c0 19.851-16.149 36-36 36h-44c-13.255.0-24 10.745-24 24s10.745 24 24 24h44c46.318.0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568.0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255.0 24-10.745 24-24S205.255.0 192 0h-44c-46.318.0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568.0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255.0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851.0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002.0 00112 192z"/></symbol><symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy"><path d="M23 2.75A2.75 2.75.0 0020.25.0H8.75A2.75 2.75.0 006 2.75v13.5A2.75 2.75.0 008.75 19h11.5A2.75 2.75.0 0023 16.25zM18.25 14.5h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5zm0-3h-7.5a.75.75.0 010-1.5h7.5a.75.75.0 010 1.5z"/><path d="M8.75 20.5A4.255 4.255.0 014.5 16.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752.0 001 5.25v16A2.752 2.752.0 003.75 24h12a2.752 2.752.0 002.75-2.75v-.75z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme"><path d="M284.286 256.002 506.143 34.144c7.811-7.811 7.811-20.475.0-28.285-7.811-7.81-20.475-7.811-28.285.0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285.0-7.81 7.811-7.811 20.475.0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475.0 28.285a19.938 19.938.0 0014.143 5.857 19.94 19.94.0 0014.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475.0-28.285L284.286 256.002z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu"><path d="M492 236H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954.0 96s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046.0-20 8.954-20 20s8.954 20 20 20h472c11.046.0 20-8.954 20-20s-8.954-20-20-20z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram"><path d="M12 2.163c3.204.0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849.0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204.0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849.0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741.0 8.333.014 7.053.072c-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948s.014 3.668.072 4.948c.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24s3.668-.014 4.948-.072c4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403.0-6.162 2.759-6.162 6.162S8.597 18.163 12 18.163s6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zM12 16c-2.209.0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796.0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795.0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="youtube"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23.0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23.0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow"><path d="M21 27v-8h3v11H0V19h3v8h18z"/><path d="M17.1.2 15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8 13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord"><path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527.41542 45.5603.39851 45.468.440769 45.4204.525289 44.7963 1.6353 44.105 3.0834 43.6209 4.2216c-5.4572-.817-10.8864-.817-16.2317.0C26.905 3.0581 26.1886 1.6353 25.5617.525289 25.5141.443589 25.4218.40133 25.3294.41542c-5.071.87338-9.9237 2.40318-14.4518 4.48238C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795 1.57795 18.7309-.943561 32.1443.293408 45.3914.299005 45.4562.335386 45.5182.385761 45.5576 6.45866 50.0174 12.3413 52.7249 18.1147 54.5195 18.2071 54.5477 18.305 54.5139 18.3638 54.4378 19.7295 52.5728 20.9469 50.6063 21.9907 48.5383 22.0523 48.4172 21.9935 48.2735 21.8676 48.2256 19.9366 47.4931 18.0979 46.6 16.3292 45.5858 16.1893 45.5041 16.1781 45.304 16.3068 45.2082 16.679 44.9293 17.0513 44.6391 17.4067 44.3461 17.471 44.2926 17.5606 44.2813 17.6362 44.3151c11.6196 5.3051 24.1992 5.3051 35.6817.0C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433 53.9057 44.6363 54.2779 44.9293 54.6529 45.2082 54.7816 45.304 54.7732 45.5041 54.6333 45.5858c-1.7687 1.0339-3.6074 1.9073-5.5412 2.637C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383c1.0662 2.0651 2.2836 4.0316 3.6241 5.8967C52.6519 54.5139 52.7526 54.5477 52.845 54.5195c5.8014-1.7946 11.684-4.5021 17.7569-8.9619C70.6551 45.5182 70.6887 45.459 70.6943 45.3942 72.1747 30.0791 68.2147 16.7757 60.1968 4.9823 60.1772 4.9429 60.1437 4.9147 60.1045 4.8978zM23.7259 37.3253c-3.4983.0-6.3808-3.2117-6.3808-7.156s2.8266-7.156 6.3808-7.156c3.5821.0 6.4367 3.2399 6.3807 7.156.0 3.9443-2.8266 7.156-6.3807 7.156zm23.5919.0c-3.4982.0-6.3807-3.2117-6.3807-7.156s2.8265-7.156 6.3807-7.156c3.5822.0 6.4367 3.2399 6.3808 7.156.0 3.9443-2.7986 7.156-6.3808 7.156z"/></symbol><symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" id="mastodon"><path fill="#fff" d="m15.054695 9.8859583c-.22611 1.1632697-2.02517 2.4363497-4.09138 2.6830797-1.0774504.12856-2.1382704.24673-3.2694704.19484-1.84996-.0848-3.30971-.44157-3.30971-.44157.0.1801.0111.35157.0333.51194.24051 1.82571 1.81034 1.93508 3.29737 1.98607 1.50088.0514 2.8373104-.37004 2.8373104-.37004l.0617 1.35686s-1.0498104.56374-2.9199404.66742c-1.03124.0567-2.3117-.0259-3.80308-.42069-3.23454998-.85613-3.79081998-4.304-3.87592998-7.8024197-.026-1.03871-.01-2.01815-.01-2.83732.0-3.57732 2.34385998-4.62587996 2.34385998-4.62587996 1.18184-.54277 3.20976-.77101 5.318-.7882499985409h.0518C9.8267646.01719834 11.856025.24547834 13.037775.78824834c0 0 2.34377 1.04855996 2.34377 4.62587996.0.0.0294 2.63937-.32687 4.47183"/><path fill="#000" d="m12.616925 5.6916583v4.3315297h-1.71607V5.8189683c0-.88624-.37289-1.33607-1.1187604-1.33607-.82467.0-1.23799.53361-1.23799 1.58875v2.30122h-1.70594v-2.30122c0-1.05514-.4134-1.58875-1.23808-1.58875-.74587.0-1.11876.44983-1.11876 1.33607v4.2042197h-1.71607V5.6916583c0-.88527.22541-1.58876.67817-2.10922.46689-.52047 1.07833-.78727 1.83735-.78727.87816.0 1.54317.33752 1.98288 1.01267l.42744.71655.42753-.71655c.43961-.67515 1.10463-1.01267 1.9828704-1.01267.75893.0 1.37037.2668 1.83735.78727.45268.52046.67808 1.22395.67808 2.10922"/></symbol></svg><footer class=footer><div class="footer_inner wrap pale"><img src=https://blog.ogenki.io/icons/footer.png class="icon icon_2 transparent" alt="Copyright ¬© 2021‚Äì2023, Smana https://github.io/Smana"><p>Copyright&nbsp;<span class=year></span>&nbsp;COPYRIGHT ¬© 2021‚Äì2023, SMANA HTTPS://GITHUB.IO/SMANA. All Rights Reserved</p><a class=to_top href=#documentTop><svg class="icon"><title>to-top</title><use xlink:href="#to-top"/></svg></a></div></footer><script type=text/javascript src=https://blog.ogenki.io/en/js/bundle.fb0be5bcaafc43d845951fd0966e48e5a7bf36be99ce2176c89d369bb5a8136dfb14e596d145cfa04c4c3b79232ffffd811a01eccee956d9d61cf49330e633c7.js integrity="sha512-+wvlvKr8Q9hFlR/Qlm5I5ae/Nr6ZziF2yJ02m7WoE237FOWW0UXPoExMO3kjL//9gRoB7M7pVtnWHPSTMOYzxw==" crossorigin=anonymous></script><script src=https://blog.ogenki.io/js/search.min.73cb82d8f274395dd220d6594053cd3d3d8ac8c97d874b5142a60b9744f3704d765551e0ade104d5803c66b731f5a7a00ac2cff33c8c9090ff8100169a3e2574.js></script></body></html>